
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Working with temporal data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/landing-page.css?v=ca7933c4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom-toggle-button.css?v=14db4526" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom-text-formatting.css?v=4ef71e6f" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part1/chapter-03/nb/03-temporal-data';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Exercises" href="04-exercises.html" />
    <link rel="prev" title="Data wrangling, grouping and aggregation" href="02-data-analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../../_static/pythongis-logo.png" class="logo__image only-light" alt=" - Home"/>
    <img src="../../../_static/pythongis-logo.png" class="logo__image only-dark pst-js-only" alt=" - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I - Python essentials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview and learning goals</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chapter-01/index.html">1. Getting started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/00-motivation.html">1.1 Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/01-computers-and-programs.html">1.2 Computers and programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/02-why-python.html">1.3 Why Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/03-writing-and-running-python-code.html">1.4 Writing and running Python code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/04-using-jupyterlab.html">1.5 Using JupyterLab for writing code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/05-quick-start.html">1.6 Quickly getting started (without installing Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-01/nb/06-installation.html">1.7 Installing Python and adding libraries</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chapter-02/index.html">2. Basic programming concepts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/00-python-basics.html">2.1 Getting started with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/01-lists-and-indices.html">2.2 Lists and indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/02-text-and-numbers.html">2.3 Working with text and numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/03-for-loops.html">2.4 for loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/04-conditional-statements.html">2.5 Conditional statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/05-functions.html">2.6 Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/06-writing-scripts.html">2.7 Writing script files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/07-modules.html">2.8 Loading and using modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-02/nb/08-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">3. Introduction to data analysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="00-pandas-basics.html">3.1 Getting started with data analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-data-manipulation.html">3.2 Common tabular operations in pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-data-analysis.html">3.3 Data wrangling, grouping and aggregation</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.4 Working with temporal data</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chapter-04/index.html">4. Introduction to data visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-04/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-04/nb/00-plotting-in-python.html">4.1 Plotting in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-04/nb/01-basic-plotting.html">4.2 Plotting with pandas and matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-04/nb/02-subplots.html">4.3 Creating subplots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-04/nb/03-plot-formatting.html">4.4 Effective plot design: line plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter-04/nb/04-exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II - Introduction to GIS with Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../part2/index.html">Overview and learning goals</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part2/chapter-05/index.html">5. Getting started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-05/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-05/nb/00-motivation-to-use-python-for-gis.html">5.1 Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-05/nb/01-introduction-to-geographic-data-in-python.html">5.2 Geographic data in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-05/nb/02-introduction-to-coordinate-reference-systems.html">5.3 Coordinate reference systems</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part2/chapter-06/index.html">6. Vector data processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/00-introduction-to-geographic-objects.html">6.1 Representing geographic data in vector format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/01-geodataframe.html">6.2 Introduction to geopandas GeoDataFrames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/02-geometric-operations.html">6.3 Common geometric operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/03-coordinate-reference-system.html">6.4 Working with map projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/04-geocoding.html">6.5 Geocoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/05-spatial-queries.html">6.6 Selecting data based on spatial relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/06-spatial-join.html">6.7 Spatial join</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/07-nearest-neighbour.html">6.8 Nearest neighbour analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/08-overlay-analysis-with-vector-data.html">6.9 Vector overlay operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-06/nb/09-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part2/chapter-07/index.html">7. Raster data processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/00-introduction-to-raster-data.html">7.1 Representing geographic data in raster format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/01-data-structures-xarray.html">7.2 Introduction to data structures in xarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/02-common-raster-operations.html">7.3 Common raster operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/03-coordinate-reference-systems-raster.html">7.4 Coordinate reference system management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/04-map-algebra.html">7.5 Map algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/05-data-cubes.html">7.6 Working with data cubes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-07/nb/06-surface-analysis.html">7.7 Surface analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part2/chapter-08/index.html">8. Geographic data visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/00-introduction-to-geographic-visualization.html">8.1 Introduction to geographic visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/01-static-vector-maps.html">8.2 Static maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/02-static-raster-maps.html">8.3 Visualizing raster layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/03-interactive-maps.html">8.4 Interactive maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/04-map-design-principles-and-colors.html">8.5 Designing maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-08/nb/05-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part2/chapter-09/index.html">9. Using online geographic data sources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-09/nb/0-learning-objectives.html">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-09/nb/00-retrieving-osm-data.html">9.1 Retrieving OpenStreetMap data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-09/nb/01-retrieving-data-from-wfs.html">9.2 Retrieving data from Web Feature Service (WFS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-09/nb/02-retrieving-data-from-wcs.html">9.3 Retrieving data from Web Coverage Service (WCS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-09/nb/03-read-data-from-spatial-databases.html">9.4 Reading data from spatial databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part2/chapter-09/nb/04-exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part III - Case studies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part3/chapter-10/index.html">10. Spatial interpolation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-10/nb/00-introduction-to-spatial-interpolation.html">Introduction to spatial interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-10/nb/01-inverse-distance-weighting.html">Inverse Distance Weighting interpolation with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-10/nb/02-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part3/chapter-11/index.html">11. Spatial network analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-11/nb/00-introduction-to-spatial-network-analysis.html">Introduction to spatial network analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-11/nb/02-multimodal-spatial-accessibility-modelling.html">Multimodal spatial accessibility analysis with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-11/nb/03-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part3/chapter-12/index.html">12. Terrain analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-12/nb/00-introduction-to-terrain-analysis.html">Introduction to terrain analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-12/nb/01-interpreting-topographic-features.html">Interpreting topographic features from raster data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../part3/chapter-12/nb/02-exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part3/chapter-13/index.html">13. Conclusions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../back-matter/appendix-a.html">A. Working effectively in Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-0-python-environments.html">Installing and managing Python environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-1-best-practices.html">Python programming best practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-2-git-github.html">Version control with git/GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-3-script-files.html">Using Python script files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-4-testing-and-debugging.html">Testing and debugging your code</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../back-matter/appendix-b.html">B. Spatial index efficiency</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-5-spatial-index.html">Spatial index - How to boost spatial queries?</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../back-matter/appendix-c.html">C. Solutions to questions and exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-6-question-solutions.html">Question solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../back-matter/nb/appendix-7-exercise-solutions.html">Exercise solutions</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../back-matter/nb/acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../back-matter/nb/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../back-matter/nb/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">About the authors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../data/index.html">Data overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/noaa-data.html">NOAA Weather data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Python-GIS-book/site/master?urlpath=lab/tree/part1/chapter-03/nb/03-temporal-data.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Python-GIS-book/site/edit/main/part1/chapter-03/nb/03-temporal-data.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button"
   title="Suggest edit"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/part1/chapter-03/nb/03-temporal-data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working with temporal data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#date-and-time-basics">Date and time basics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-temporal-data-in-python">Working with temporal data in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-datetime-objects">Constructing datetime objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-temporal-components-from-datetime-object">Parsing temporal components from datetime object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-temporal-data-in-pandas">Working with temporal data in pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-time-zones-in-pandas">Handling time zones in pandas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-data-using-a-datetimeindex">Selecting data using a DatetimeIndex</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-data-using-a-dateoffset">Selecting data using a DateOffset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shifting-leading-and-lagging-time-series-data">Shifting: Leading and lagging time series data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-time-series-data">Resampling time series data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-rolling-statistics">Calculating rolling statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">Footnotes</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-temporal-data">
<h1>Working with temporal data<a class="headerlink" href="#working-with-temporal-data" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>“Ever since the dawn of civilization, people have not been content to see events as unconnected and inexplicable. They have craved an understanding of the underlying order in the world.”</p>
<p>Stephen Hawking (1988)</p>
</div></blockquote>
<p>Time is one of the most fundamental ways humans organize things in life and what we use to understand of the underlying world, as Stephen Hawking famously put it in his book <em>A Brief History of Time</em> (<span id="id1"><a class="reference internal" href="../../../back-matter/nb/references.html#id8" title="Stephen Hawking. A Brief History of Time: From the Big Bang to Black Holes. Bantam, London, 1988.">Hawking, 1988</a></span>). Hence, it is not surprising that the time dimension is very commonly attached to almost all data that we have in the world (the other dimension is naturally space or location, which we will focus in Part II). Hence, being able to handle and work with temporal information is extremely important when doing data analysis. Time information in the data allows us to see patterns through time (trends) as well as to make predictions into the future (at varying level of confidence). In this section, we will introduce some of the core ideas and functionalities how you can work with temporal data in Python and <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<section id="date-and-time-basics">
<h2>Date and time basics<a class="headerlink" href="#date-and-time-basics" title="Link to this heading">#</a></h2>
<p>Before doing any programming, we need to understand a few details about time conventions themselves. There are a couple of ways how time information (commonly referred as a <code class="docutils literal notranslate"><span class="pre">timestamp</span></code>) is typically represented. The first one is to represent the temporal information as text with specific format such as <code class="docutils literal notranslate"><span class="pre">&quot;2020-12-24T09:12:45Z&quot;</span></code>, which follows the international ISO 8601 standard <a class="footnote-reference brackets" href="#isostandard" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. In this format, the date components (year, month, day) are separated with dashes (<code class="docutils literal notranslate"><span class="pre">-</span></code>) and the time components (hour, minute, second) are separated with colons (<code class="docutils literal notranslate"><span class="pre">:</span></code>). Typically there is the letter <code class="docutils literal notranslate"><span class="pre">T</span></code> separating the date and time components from each other (though in some other formats there could just be a space between them).</p>
<p>The letter <code class="docutils literal notranslate"><span class="pre">Z</span></code> at the end of the string relates to time zones and means that the time here is represented as Coordinated Universal Time (UTC). Time zone information around the world is expressed using negative or positive offsets from the UTC time standard. <code class="docutils literal notranslate"><span class="pre">UTC±00:00</span></code> is the same as Greenwich Mean Time (GMT) used for example in the United Kingdom (during winter months), and it was chosen after a series of conferences between 1881-1884 (Ogle, 2015) as the worldwide standard for representing the zone 0 to which all other time zones in the world are relative. For instance, local time in Finland is two hours ahead of UTC, meaning that the time zone information is expressed as <code class="docutils literal notranslate"><span class="pre">UTC+2</span></code> or <code class="docutils literal notranslate"><span class="pre">UTC+02:00</span></code>, whereas the local time in New York is four hours behind UTC (i.e., <code class="docutils literal notranslate"><span class="pre">UTC-4</span></code>).</p>
<p>Another common way to represent time in addition to an ISO-standardized timestamp is to use “Unix time” (also known as “Epoch time” or “POSIX time”). Unix time is expressed as the number of seconds since the start of the “Unix Epoch”, which began on the first of January 1970 at midnight in UTC (i.e., <code class="docutils literal notranslate"><span class="pre">1970-01-01T00:00:00Z</span></code>). This system was developed to describe a point in time in a simple numerical format and it is widely used in computers by different operating systems. One second is the increment in Unix time, such that the Unix time of December 22nd 2020 at 15:00:00 (UTC) would be represented as a single number <code class="docutils literal notranslate"><span class="pre">1608649200</span></code>. Using this kind of numerical representation of time makes it much easier for computers to store and manipulate the time information compared to having the information in a textual format (e.g., <code class="docutils literal notranslate"><span class="pre">2020-12-22T15:00:00Z</span></code>).</p>
<p>Finally, an important convention that relates to time and time zones is the concept called Daylight Saving Time (DST), also known as summer time. DST is a commonly used practice for advancing clocks typically by an hour during warmer months so that darkness falls at a later clock time. This is also the reason why the time zone information in Finland during DST has an offset of +03:00 (summer time) instead of +02:00 which follows the official time zone specification for Finland, for example. DST became a common practice after the global energy crisis in the 1970s and was introduced in many countries during the following decade. However, some countries have never followed this convention and there is an ongoing discussion about whether to abandon this convention, for example in the EU.</p>
</section>
<section id="working-with-temporal-data-in-python">
<h2>Working with temporal data in Python<a class="headerlink" href="#working-with-temporal-data-in-python" title="Link to this heading">#</a></h2>
<p>Next we will learn how temporal data can be handled in Python in general. The most fundamental Python library for dealing with temporal data is called <code class="docutils literal notranslate"><span class="pre">datetime</span></code>, which supplies functionalities to construct and manipulate dates and times. The module is one of the Python’s standard libraries, hence you do not need to install it separately. Other useful libraries for dealing with time and dates are <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">calendar</span></code>, which provide some additional functionalities to supplement those provided by <code class="docutils literal notranslate"><span class="pre">datetime</span></code>. Beyond this, the <code class="docutils literal notranslate"><span class="pre">pytz</span></code> library provides useful functionalities to deal with time zone information and <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> provides some handy things to automate date parsing. Most often the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> module and <code class="docutils literal notranslate"><span class="pre">pytz</span></code> (in addition to <code class="docutils literal notranslate"><span class="pre">pandas</span></code>) provide everything you need when doing analysis with temporal data.</p>
</section>
<section id="constructing-datetime-objects">
<h2>Constructing datetime objects<a class="headerlink" href="#constructing-datetime-objects" title="Link to this heading">#</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object is a representation of time in a way that Python can understand and operate with it. With the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> library it is possible to create a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object, for example by <code class="docutils literal notranslate"><span class="pre">parsing</span></code> it from text following the ISO 8601 format or from the Unix timestamp (notice that the name of the library and the object are both <code class="docutils literal notranslate"><span class="pre">datetime</span></code>). Let’s see how we can create a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object from text using the  <code class="docutils literal notranslate"><span class="pre">.strptime()</span></code> function. The <code class="docutils literal notranslate"><span class="pre">.strptime()</span></code> function takes the variable <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> as the first argument representing the time in a textual format and a second argument (<code class="docutils literal notranslate"><span class="pre">&quot;%Y-%m-%dT%H:%M:%S&quot;</span></code>) which looks quite complicated, but it is the <code class="docutils literal notranslate"><span class="pre">format</span> <span class="pre">code</span></code> that instructs <code class="docutils literal notranslate"><span class="pre">datetime</span></code> how the textual representation of time should be interpreted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">timestamp</span> <span class="o">=</span> <span class="s2">&quot;2020-12-22T15:00:00&quot;</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2020, 12, 22, 15, 0)
</pre></div>
</div>
</div>
</div>
<p>As a result we get a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object in which the date has been converted into a set of numbers, where the first is the year, the second is the month, the third is the day, and so on. This structure is always the same, no matter which format the input data has been provided. By using format codes (i.e., the second argument of the function), we can tell the computer that the first component in our string represents year in 4 digits. For example, the <code class="docutils literal notranslate"><span class="pre">%Y</span></code> characters (i.e., a directive) are a special way to instruct the computer how to interpret the starting characters in the timestamp. In a similar manner, we can instruct the computer to read the month based on numbers with two digits (<code class="docutils literal notranslate"><span class="pre">12</span></code>) using the directive <code class="docutils literal notranslate"><span class="pre">%m</span></code>. As you can see, there is always a <code class="docutils literal notranslate"><span class="pre">%</span></code> character and then some letter after it, which is the way how we determine how the date is formatted in our text. Notice that the date components are separated with dashes (<code class="docutils literal notranslate"><span class="pre">-</span></code>) and the time components are separated with colons (<code class="docutils literal notranslate"><span class="pre">:</span></code>). As we can see from our format code, we can add those separator characters between the directives just as they are recorded in the timestamp. Following this approach it is possible to parse basically any kind of time information represented as text. A few of the most commonly used <code class="docutils literal notranslate"><span class="pre">datetime</span></code> format code directives are listed in Table 3.1.</p>
<p>: <em><strong>Table 3.1</strong>. Most commonly used <code class="docutils literal notranslate"><span class="pre">datetime</span></code> directives and their meaning.</em></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Directive</p></th>
<th class="head text-left"><p>Description</p></th>
<th class="head text-left"><p>Examples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%y</span></code></p></td>
<td class="text-left"><p>Year without century as a</p></td>
<td class="text-left"><p>00, 20, etc.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>zero-padded number</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%Y</span></code></p></td>
<td class="text-left"><p>Year including century as a</p></td>
<td class="text-left"><p>2000, 1920, etc.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>zero-padded number</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%m</span></code></p></td>
<td class="text-left"><p>Month as a zero-padded number</p></td>
<td class="text-left"><p>01, …, 12</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%b</span></code></p></td>
<td class="text-left"><p>Month as abbreviated name</p></td>
<td class="text-left"><p>Jan, …, Dec</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%B</span></code></p></td>
<td class="text-left"><p>Month as full name</p></td>
<td class="text-left"><p>January, …, December</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%d</span></code></p></td>
<td class="text-left"><p>Day of the month as a</p></td>
<td class="text-left"><p>01, …, 31</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>zero-padded number</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%H</span></code></p></td>
<td class="text-left"><p>Hour (24-hour clock) as a</p></td>
<td class="text-left"><p>00, …, 23</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>zero-padded number</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%I</span></code></p></td>
<td class="text-left"><p>Hour (12-hour clock) as a</p></td>
<td class="text-left"><p>01, …, 12</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>zero-padded number</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%p</span></code></p></td>
<td class="text-left"><p>AM or PM (12-hour clock)</p></td>
<td class="text-left"><p>am, pm, AM, PM</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%M</span></code></p></td>
<td class="text-left"><p>Minute as a zero-padded number</p></td>
<td class="text-left"><p>00, …, 59</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%S</span></code></p></td>
<td class="text-left"><p>Second as a zero-padded number</p></td>
<td class="text-left"><p>00, …, 59</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%z</span></code></p></td>
<td class="text-left"><p>UTC offset (can be empty)</p></td>
<td class="text-left"><p>+0000, +2000, etc.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%Z</span></code></p></td>
<td class="text-left"><p>Time zone name (can be empty)</p></td>
<td class="text-left"><p>UTC, GMT</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%a</span></code></p></td>
<td class="text-left"><p>Weekday as abbreviated name</p></td>
<td class="text-left"><p>Mon, …, Sun</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%A</span></code></p></td>
<td class="text-left"><p>Weekday as full name</p></td>
<td class="text-left"><p>Monday, …, Sunday</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">%w</span></code></p></td>
<td class="text-left"><p>Weekday as a number where 0 is</p></td>
<td class="text-left"><p>0, …, 6</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Sunday and 6 is Saturday</p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>To further solidify your understanding of how the timestamps can be parsed, let’s look at a few more examples where we also include time zone information and parse the date information based on a format that we might typically use to record dates as humans (without the time component). Let’s start by adding <code class="docutils literal notranslate"><span class="pre">+0200</span></code> to the end of the timestamp to express the UTC+2 time zone.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestamp_with_tz</span> <span class="o">=</span> <span class="s2">&quot;2020-12-22T15:00:00 +0200&quot;</span>
<span class="n">dtz</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timestamp_with_tz</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S %z&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dtz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020-12-22 15:00:00+02:00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">dtz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtz</span><span class="o">.</span><span class="n">tzinfo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.timezone(datetime.timedelta(seconds=7200))
</pre></div>
</div>
</div>
</div>
<p>As we can see, now we produced a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object including the time zone information in the <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code> attribute, which shows the offset (i.e., <code class="docutils literal notranslate"><span class="pre">timedelta</span></code>) from UTC in seconds. Having the timezone information attached can be very useful if doing analysis with temporal data that has been collected from different parts of the world (with different time zones). Let’s look at another example in which we parse the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object from a textual representation that is written in a way that we might normally write dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">written_date</span> <span class="o">=</span> <span class="s2">&quot;22 December 2020&quot;</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">written_date</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> %B %Y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2020, 12, 22, 0, 0)
</pre></div>
</div>
</div>
</div>
<p>Here, we used a different format for instructing the computer how to read the text by using <code class="docutils literal notranslate"><span class="pre">%B</span></code> to denote a written month name. We also changed the order of the directives and used an empty space between them. Writing the exact form of how the timestamp information is written can be quite tedious work, especially if working with handwritten data where the structure of the time information can vary considerably. Luckily, Python provides a handy library called <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> that automates most of this work. We can use a function called <code class="docutils literal notranslate"><span class="pre">.parse()</span></code> to automatically construct the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object from various formats.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>

<span class="n">timestamp_with_tz</span> <span class="o">=</span> <span class="s2">&quot;2020-12-22T15:00:00 +0200&quot;</span>
<span class="n">written_date</span> <span class="o">=</span> <span class="s2">&quot;22 December 2020&quot;</span>
<span class="n">dt1</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">timestamp_with_tz</span><span class="p">)</span>
<span class="n">dt2</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">written_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dt1</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">dt2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020-12-22 15:00:00+02:00
2020-12-22 00:00:00
</pre></div>
</div>
</div>
</div>
<p>The previous examples have all focused on using a textual representation of time as an input. Naturally it is also possible to construct a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object using the Unix time representation. Because Unix time is a simple number, it is much more straightforward to parse and use to create a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object. Here is an example of how we would convert the Unix time <code class="docutils literal notranslate"><span class="pre">1608649200</span></code> into a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object using the <code class="docutils literal notranslate"><span class="pre">.fromtimestamp()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unix_time</span> <span class="o">=</span> <span class="mi">1608649200</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">unix_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2020, 12, 22, 17, 0)
</pre></div>
</div>
</div>
</div>
<p>Wait, what? In the beginning of this section, we said that the Unix time <code class="docutils literal notranslate"><span class="pre">1608649200</span></code> should be “December 22nd 2020 at 15:00:00 (UTC)”, but here we see the result as five o’clock (i.e., <code class="docutils literal notranslate"><span class="pre">17,</span> <span class="pre">0</span></code>). This is due to the fact that the computer that this code was written with was located in a Finnish time zone (UTC+02) and as Unix time is always passed as UTC, the computer automatically returns the timestamp in the local timezone (i.e., in Finnish time or whatever the local time has been specified in your computer’s settings). This is a good thing to understand because it can be rather confusing when working with temporal data.</p>
<p>Finally, it is of course possible to initialize the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object directly by passing integer values into the object itself. Here we use the same date and time as before but add <code class="docutils literal notranslate"><span class="pre">30</span></code> seconds to the end.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2020, 12, 22, 17, 0, 30)
</pre></div>
</div>
</div>
</div>
</section>
<section id="parsing-temporal-components-from-datetime-object">
<h2>Parsing temporal components from datetime object<a class="headerlink" href="#parsing-temporal-components-from-datetime-object" title="Link to this heading">#</a></h2>
<p>There are few useful tricks that you can use with the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects. It is for example possible to parse specific temporal components directly from the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object. You can, for example, access the <code class="docutils literal notranslate"><span class="pre">.year</span></code>, <code class="docutils literal notranslate"><span class="pre">.month</span></code>, <code class="docutils literal notranslate"><span class="pre">.day</span></code>, <code class="docutils literal notranslate"><span class="pre">.hour</span></code>, <code class="docutils literal notranslate"><span class="pre">.minute</span></code> and <code class="docutils literal notranslate"><span class="pre">.second</span></code> attributes easily, which will return the value of the temporal element as an integer number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020
12
22
17
</pre></div>
</div>
</div>
</div>
<p>In addition, you can parse the day of week, for example, using the <code class="docutils literal notranslate"><span class="pre">.weekday()</span></code> function or parse only the date components from the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object by using the <code class="docutils literal notranslate"><span class="pre">.date()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
2020-12-22
</pre></div>
</div>
</div>
</div>
<p>By using the <code class="docutils literal notranslate"><span class="pre">.strftime()</span></code> function, you can use the same directives from Table 2.1 to construct and convert the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object to any text representation of the date and time. Below you can see how this function can be used to create an easily understandable date and time text string based on our date and time information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> %B %Y is a %A. The time is %I:%M %p.&quot;</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">custom_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;22 December 2020 is a Tuesday. The time is 05:00 PM.&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="working-with-temporal-data-in-pandas">
<h2>Working with temporal data in pandas<a class="headerlink" href="#working-with-temporal-data-in-pandas" title="Link to this heading">#</a></h2>
<p>After learning the basics of how temporal data can be represented as <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects, we can continue and see how temporal data can be manipulated in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is extremely powerful and flexible when it comes to working with temporal data. For instance, all of the simple tricks that we saw earlier with <code class="docutils literal notranslate"><span class="pre">datetime</span></code> can also be done using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. When doing data analysis with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, instead of dealing with single time observations, you often work with time series data such as daily temperature values that we analyzed in the previous section. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> supports many useful functionalities related to parsing, manipulating, and aggregating time series data. Let’s start exploring the temporal capabilities of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> by reading daily temperature observations from one of the data files we used in the previous section and following the earlier approach. As a reminder, this the format of the file data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STATION</span>           <span class="n">ELEVATION</span>  <span class="n">LATITUDE</span>   <span class="n">LONGITUDE</span>  <span class="n">DATE</span>     <span class="n">PRCP</span>     <span class="n">SNWD</span><span class="o">...</span>
<span class="o">-----------------</span> <span class="o">----------</span> <span class="o">----------</span> <span class="o">----------</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">----...</span>
<span class="n">GHCND</span><span class="p">:</span><span class="n">FI000007501</span>        <span class="mi">179</span>    <span class="mf">67.3678</span>    <span class="mf">26.6328</span> <span class="mi">19080101</span> <span class="mf">0.00</span>     <span class="o">-</span><span class="mf">999.</span><span class="o">..</span>
<span class="n">GHCND</span><span class="p">:</span><span class="n">FI000007501</span>        <span class="mi">179</span>    <span class="mf">67.3678</span>    <span class="mf">26.6328</span> <span class="mi">19080102</span> <span class="mf">0.00</span>     <span class="o">-</span><span class="mf">999.</span><span class="o">..</span>
<span class="n">GHCND</span><span class="p">:</span><span class="n">FI000007501</span>        <span class="mi">179</span>    <span class="mf">67.3678</span>    <span class="mf">26.6328</span> <span class="mi">19080103</span> <span class="mf">0.12</span>     <span class="o">-</span><span class="mf">999.</span><span class="o">..</span>
</pre></div>
</div>
<p>You may notice a few things here: First, there are some additional data columns that were not present in the <code class="docutils literal notranslate"><span class="pre">helsinki-kumpula.txt</span></code> file we had worked with most in the previous section. We will ignore these here, but it worth noting their presence. We can specify with the parameter <code class="docutils literal notranslate"><span class="pre">usecols</span></code> that we only want to keep four columns from the file (station number, date information, and temperature). Second, there are timestamps stored in the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column. These can be automatically converted to <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects when reading the data by using the <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code> parameter and providing a list of column names that should be parsed by <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read the data and parse dates</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;data/finnish-stations/sodankyla-aws.txt&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">fp</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-9999&quot;</span><span class="p">],</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;STATION&quot;</span><span class="p">,</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span> <span class="s2">&quot;TMAX&quot;</span><span class="p">,</span> <span class="s2">&quot;TMIN&quot;</span><span class="p">],</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Rename the columns</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;STATION&quot;</span><span class="p">:</span> <span class="s2">&quot;STATION_ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TMAX&quot;</span><span class="p">:</span> <span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TMIN&quot;</span><span class="p">:</span> <span class="s2">&quot;TMIN_F&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>DATE</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-01</td>
      <td>2.0</td>
      <td>-37.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-02</td>
      <td>6.0</td>
      <td>-26.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-03</td>
      <td>7.0</td>
      <td>-27.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-04</td>
      <td>-3.0</td>
      <td>-27.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-05</td>
      <td>4.0</td>
      <td>-36.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see, the values in <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column were automatically parsed into a format that is easier to read than the original one. When using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">datetime</span></code> parsing, the timestamps can be represented in different formats such as text in the ISO 8601 format or Unix times. Let’s take a look at the values in our <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   1908-01-01
1   1908-01-02
2   1908-01-03
3   1908-01-04
4   1908-01-05
Name: DATE, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<p>As we can see, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> converted the timestamp values into a time series having a specific data type called <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>. The individual value of the time series is a specific <code class="docutils literal notranslate"><span class="pre">pandas</span></code> object called a <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> that is similar to Python’s regular <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object that we saw previously.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;DATE&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1908-01-01 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TimeStamp</span></code> object contains all the same attributes as the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object, but in addition it has many useful attributes and functions that can be used in a vectorized manner. For instance, you can parse different temporal components from the time series stored in a column very efficiently. Let’s parse the temporal components from <code class="docutils literal notranslate"><span class="pre">DATE</span></code> into columns <code class="docutils literal notranslate"><span class="pre">YEAR</span></code>, <code class="docutils literal notranslate"><span class="pre">MONTH</span></code>, <code class="docutils literal notranslate"><span class="pre">DAY</span></code> and <code class="docutils literal notranslate"><span class="pre">HOUR</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;MONTH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DAY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;HOUR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>DATE</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
      <th>YEAR</th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>HOUR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-01</td>
      <td>2.0</td>
      <td>-37.0</td>
      <td>1908</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-02</td>
      <td>6.0</td>
      <td>-26.0</td>
      <td>1908</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-03</td>
      <td>7.0</td>
      <td>-27.0</td>
      <td>1908</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-04</td>
      <td>-3.0</td>
      <td>-27.0</td>
      <td>1908</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GHCND:FI000007501</td>
      <td>1908-01-05</td>
      <td>4.0</td>
      <td>-36.0</td>
      <td>1908</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now the new columns have corresponding integer values for each temporal component. We were able to access all the temporal attributes by using the <code class="docutils literal notranslate"><span class="pre">.dt</span></code> accessor that is available for all <code class="docutils literal notranslate"><span class="pre">Series</span></code> having the <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> data type. This is perhaps also a good time to note that when reading in dates that lack time data (hours, minutes, and seconds), the missing times will be filled in as midnight on the associated date. For example, the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> we saw above for January 1st, 1908 had assigned a time as follows: <code class="docutils literal notranslate"><span class="pre">Timestamp('1908-01-01</span> <span class="pre">00:00:00')</span></code>.</p>
<p>We can also combine the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> functionalities with other methods from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. For example, we can check that we have observations from 117 years in total.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>117
</pre></div>
</div>
</div>
</div>
<section id="handling-time-zones-in-pandas">
<h3>Handling time zones in pandas<a class="headerlink" href="#handling-time-zones-in-pandas" title="Link to this heading">#</a></h3>
<p>When reading time series data with <code class="docutils literal notranslate"><span class="pre">pandas</span></code> as we did previously, the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects are represented without time zone information. However, it is straightforward to attach time zone information to a <code class="docutils literal notranslate"><span class="pre">Series</span></code> with <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects using a method called <code class="docutils literal notranslate"><span class="pre">.tz_localize()</span></code>. When manipulating the data based on time information in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, the first step  is to specify a <em><a class="reference internal" href="../../../back-matter/nb/glossary.html#term-DatetimeIndex"><span class="xref std std-term">DatetimeIndex</span></a></em> for your <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> (here based on the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column) with the <code class="docutils literal notranslate"><span class="pre">.set_index()</span></code> method. Next, we can set the index and specify an appropriate time zone for our data (Europe/Helsinki). We can also specify the <code class="docutils literal notranslate"><span class="pre">nonexistent</span></code> parameter as “shift_forward”, due to the fact that when the clocks are adjusted when changing from winter time to summer time there is literally one hour during the night that does not exist. With this parameter we tell <code class="docutils literal notranslate"><span class="pre">pandas</span></code> that this is OK, and we just want to shift the time forward (by an hour in most cases) in case there are such “non-existing” time observations. With the <code class="docutils literal notranslate"><span class="pre">ambiguous</span></code> parameter, we tell <code class="docutils literal notranslate"><span class="pre">pandas</span></code> that when adjusting the clocks backwards (moving from summer time to winter time), the observations having ambiguous times (e.g., duplicate timestamps due to DST) are set to <code class="docutils literal notranslate"><span class="pre">NaT</span></code> (Not-a-Time). Notice that it is up to you to decide the appropriate way for handling such cases (there are also other options for the <code class="docutils literal notranslate"><span class="pre">ambiguous</span></code> parameter such as “infer”).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;DATE&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s2">&quot;Europe/Helsinki&quot;</span><span class="p">,</span> <span class="n">nonexistent</span><span class="o">=</span><span class="s2">&quot;shift_forward&quot;</span><span class="p">,</span> <span class="n">ambiguous</span><span class="o">=</span><span class="s2">&quot;NaT&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
      <th>YEAR</th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>HOUR</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-10-22 00:00:00+03:00</th>
      <td>GHCND:FI000007501</td>
      <td>48.0</td>
      <td>NaN</td>
      <td>2024</td>
      <td>10</td>
      <td>22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2024-10-23 00:00:00+03:00</th>
      <td>GHCND:FI000007501</td>
      <td>40.0</td>
      <td>30.0</td>
      <td>2024</td>
      <td>10</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2024-10-24 00:00:00+03:00</th>
      <td>GHCND:FI000007501</td>
      <td>40.0</td>
      <td>27.0</td>
      <td>2024</td>
      <td>10</td>
      <td>24</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2024-10-25 00:00:00+03:00</th>
      <td>GHCND:FI000007501</td>
      <td>46.0</td>
      <td>29.0</td>
      <td>2024</td>
      <td>10</td>
      <td>25</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2024-10-26 00:00:00+03:00</th>
      <td>GHCND:FI000007501</td>
      <td>44.0</td>
      <td>28.0</td>
      <td>2024</td>
      <td>10</td>
      <td>26</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column has been set as our index and it was moved to the left and replaced the original sequential numbers. Notice that the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column is no longer part of the columns in our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> (we will later see how to restore it as a regular column). Also, the time zone information has been attached to the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects as can be seen by the five last characters showing <code class="docutils literal notranslate"><span class="pre">+03:00</span></code>. From this information we can see that the time zone in Finland is +3 hours for the given dates (i.e., summer time). We can easily access the index values by calling it. Let’s check the first and last values of <code class="docutils literal notranslate"><span class="pre">data.index</span></code> and its data type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1908-01-01 00:00:00+0140&#39;, tz=&#39;Europe/Helsinki&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2024-10-26 00:00:00+0300&#39;, tz=&#39;Europe/Helsinki&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.indexes.datetimes.DatetimeIndex
</pre></div>
</div>
</div>
</div>
<p>As we can see, the index is now a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>, which is essentially an array of <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects armed with all the attributes and methods that we have seen in the previous examples. In addition, our index has the time zone specified as “Europe/Helsinki”. Tip: If you want to know which time zones are available, you can access them using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">pytz</span> <span class="pre">import</span> <span class="pre">all_timezones</span></code>, which stores all available time zones as a “lazy list” in the variable <code class="docutils literal notranslate"><span class="pre">all_timezones</span></code>.</p>
<p>Looking at the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> values, we can see that there are some interesting things in our date index. First, the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects in the index range from the year 1908 seem to have unusual time zone information attached to them (+01:40), which differs from the offset of the last observations (+03:00) by an hour and twenty minutes. This might seem a bit strange, although everything is as it should be. This difference relates to the international time standards. Representing local time using a time zone specification as an offset from UTC is merely a contract between countries that aims to standardize the representation of time in different parts of the world. But as with any international contract, the standardization process can happen at different times in different countries, and it is not unheard of to make changes to these agreements. An example of such a change can be witnessed here, as Finland changed its time zone from Helsinki Mean Time (with +01:40 offset from UTC) to Eastern European Time (with +02:00 from UTC) on May 1st, 1921. Hence, all timestamps recorded before the aforementioned date have a somewhat unusual offset from UTC (100 minutes). Similar special arrangements have been quite common in history, so it is good to be careful and aware of these situations whenever working with historical time series. Another important convention relates to DST, which was introduced in Finland in 1981 and is the reason why the last values in our <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> have an offset of +03:00 (summer time) instead of +02:00. As you might guess, all these international practices and contracts can make working with date and time information quite tricky. Luckily, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> (and the underlying <code class="docutils literal notranslate"><span class="pre">pytz</span></code> library) handles these things very well and we do not need to worry too much about the international time conventions.</p>
<p>On some occasions, you might want to convert your time series data from one time zone to another. If you, for example, would like to understand what the time was in New York when these weather observations were recorded, you could convert the time information easily using the <code class="docutils literal notranslate"><span class="pre">.dt.tz_convert()</span></code> function. Before making the conversion between the time zones, we need to return the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> <code class="docutils literal notranslate"><span class="pre">Series</span></code> from the index back to a normal <code class="docutils literal notranslate"><span class="pre">pandas</span></code> column using the <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code> method. This method will restore the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column in the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as a normal column. When manipulating time series, it is quite typical to set a specific column as an index for the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and then swap it back to a “normal” column for further manipulation as in the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;DATE&#39; column is returned back as a normal column</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;NY_DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s2">&quot;US/Eastern&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                       DATE         STATION_ID  TMAX_F  TMIN_F  YEAR  MONTH  \
0 1908-01-01 00:00:00+01:40  GHCND:FI000007501     2.0   -37.0  1908      1   
1 1908-01-02 00:00:00+01:40  GHCND:FI000007501     6.0   -26.0  1908      1   
2 1908-01-03 00:00:00+01:40  GHCND:FI000007501     7.0   -27.0  1908      1   
3 1908-01-04 00:00:00+01:40  GHCND:FI000007501    -3.0   -27.0  1908      1   
4 1908-01-05 00:00:00+01:40  GHCND:FI000007501     4.0   -36.0  1908      1   

   DAY  HOUR                   NY_DATE  
0    1     0 1907-12-31 17:20:00-05:00  
1    2     0 1908-01-01 17:20:00-05:00  
2    3     0 1908-01-02 17:20:00-05:00  
3    4     0 1908-01-03 17:20:00-05:00  
4    5     0 1908-01-04 17:20:00-05:00  
</pre></div>
</div>
</div>
</div>
<p>Now we can see that the timestamps were converted to represent the times in the US/Eastern time zone and stored in the <code class="docutils literal notranslate"><span class="pre">NY_TIME</span></code> column. For example, the first observation in our data recorded at midnight on the 1st of January in 1908 was correctly converted to a value from the last day of previous year at 5:20 PM (<code class="docutils literal notranslate"><span class="pre">1907-12-31</span> <span class="pre">17:20</span></code>). This functionality can be very useful when working with temporal data from different parts of the world. Quite often the data collected from different global services (such as tweets collected from Twitter/X) store date information as UTC values. Hence, it is up to the user to select the correct local time for tweets posted in different parts of the world. Using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> for doing these kinds of manipulations with temporal data is extremely handy and efficient. In case your data are already stored with a different timezone, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> makes your life easy because timestamps are always stored in UTC under the hood. This means that it is straightforward to do operations between the two time series without any additional timezone conversions. We can, for example, do simple calculations between two <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects with dates recorded in different timezones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;DATE&quot;</span><span class="p">,</span> <span class="s2">&quot;TMAX_F&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;DATE&quot;</span><span class="p">)</span>
<span class="n">sample1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TMAX_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1908-01-01 00:00:00+01:40</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1908-01-02 00:00:00+01:40</th>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1908-01-03 00:00:00+01:40</th>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1908-01-04 00:00:00+01:40</th>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>1908-01-05 00:00:00+01:40</th>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;NY_DATE&quot;</span><span class="p">,</span> <span class="s2">&quot;TMAX_F&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">sample2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;NY_DATE&quot;</span><span class="p">)</span>
<span class="n">sample2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TMAX_F</th>
    </tr>
    <tr>
      <th>NY_DATE</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1907-12-31 17:20:00-05:00</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1908-01-01 17:20:00-05:00</th>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1908-01-02 17:20:00-05:00</th>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1908-01-03 17:20:00-05:00</th>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>1908-01-04 17:20:00-05:00</th>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we have the same temperature values in both <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects but these observations are stored with different time zones. At this point, we could, for instance, sum up these temperatures, which works because the time of the observations matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sample2</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
1907-12-31 22:20:00+00:00     4.0
1908-01-01 22:20:00+00:00    12.0
1908-01-02 22:20:00+00:00    14.0
1908-01-03 22:20:00+00:00    -6.0
1908-01-04 22:20:00+00:00     8.0
Name: TMAX_F, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As you can see, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> automatically converted the temporal information to the UTC timezone and the temperature values were summed correctly.</p>
</section>
</section>
<section id="selecting-data-using-a-datetimeindex">
<h2>Selecting data using a DatetimeIndex<a class="headerlink" href="#selecting-data-using-a-datetimeindex" title="Link to this heading">#</a></h2>
<p>In Chapter 3.3, we saw how to select observations using simple string manipulation operations applied to the timestamp. Although this worked quite well for our specific case, it is a rather clumsy and inflexible approach to work with temporal information. A much better approach is to take advantage of the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects stored in the time series. Let’s again first set the <code class="docutils literal notranslate"><span class="pre">DATE</span></code> column as the index for our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> using the <code class="docutils literal notranslate"><span class="pre">.set_index()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;data/finnish-stations/sodankyla-aws.txt&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">fp</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-9999&quot;</span><span class="p">],</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;STATION&quot;</span><span class="p">,</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span> <span class="s2">&quot;TMAX&quot;</span><span class="p">,</span> <span class="s2">&quot;TMIN&quot;</span><span class="p">],</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Rename the columns</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;STATION&quot;</span><span class="p">:</span> <span class="s2">&quot;STATION_ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TMAX&quot;</span><span class="p">:</span> <span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TMIN&quot;</span><span class="p">:</span> <span class="s2">&quot;TMIN_F&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1"># Set DATE as index</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;DATE&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1908-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>2.0</td>
      <td>-37.0</td>
    </tr>
    <tr>
      <th>1908-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>6.0</td>
      <td>-26.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we have now equipped our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>, it is easy to filter the data based on specific criteria and select all observations that have been recorded in specific months of 2019, for example. To do this, we can use <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> indexing similar to how we did before, but pass the criteria for selecting the data using either <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects or strings that can be interpreted as a date. For instance, we can select the observations for January 2019 based on <code class="docutils literal notranslate"><span class="pre">datetime</span></code> labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">january</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_dt</span><span class="p">:</span><span class="n">end_dt</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">january</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">january</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First obs: </span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="se">\n</span><span class="s2">Last obs: </span><span class="si">{</span><span class="n">last</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First obs: 2019-01-01 00:00:00
Last obs: 2019-01-31 00:00:00
</pre></div>
</div>
</div>
</div>
<p>As we mentioned, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> also provides a nice, easy way to select observations for specific month by specifying the selection criteria as a string. This approach is convenient because we can select observations by passing a single label to the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> indexer and <code class="docutils literal notranslate"><span class="pre">pandas</span></code> automatically detects what should be done based on the string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">february</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2019-02&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">february</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">february</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First obs: </span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="se">\n</span><span class="s2">Last obs: </span><span class="si">{</span><span class="n">last</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First obs: 2019-02-01 00:00:00
Last obs: 2019-02-28 00:00:00
</pre></div>
</div>
</div>
</div>
<p>As a result, we selected all observations that were recorded during February 2019. Using this approach, called partial string indexing, is useful because it makes it easy for us to deal with a irregular number of days in February (such as in leap years). By passing the time window as a string that comprises the year and month information, we do not need to worry about leap years ourselves as <code class="docutils literal notranslate"><span class="pre">pandas</span></code> does this automatically for us.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leap_year</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020-02&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">leap_year</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">leap_year</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First obs: </span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="se">\n</span><span class="s2">Last obs: </span><span class="si">{</span><span class="n">last</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First obs: 2020-02-01 00:00:00
Last obs: 2020-02-29 00:00:00
</pre></div>
</div>
</div>
</div>
<p>Following the same approach, we can adjust the criteria to have a more specific time range such as first two weeks of February of 2018.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_two_weeks</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018-02-01&quot;</span><span class="p">:</span><span class="s2">&quot;2018-02-14&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">first_two_weeks</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-02-13</th>
      <td>GHCND:FI000007501</td>
      <td>25.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>2018-02-14</th>
      <td>GHCND:FI000007501</td>
      <td>30.0</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or we can select data covering the whole year of 2018.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>29.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2018-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>25.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>27.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>26.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2018-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>21.0</td>
      <td>-5.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-12-27</th>
      <td>GHCND:FI000007501</td>
      <td>15.0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>2018-12-28</th>
      <td>GHCND:FI000007501</td>
      <td>17.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2018-12-29</th>
      <td>GHCND:FI000007501</td>
      <td>30.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2018-12-30</th>
      <td>GHCND:FI000007501</td>
      <td>31.0</td>
      <td>-12.0</td>
    </tr>
    <tr>
      <th>2018-12-31</th>
      <td>GHCND:FI000007501</td>
      <td>25.0</td>
      <td>-12.0</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 3 columns</p>
</div></div></div>
</div>
<section id="selecting-data-using-a-dateoffset">
<h3>Selecting data using a DateOffset<a class="headerlink" href="#selecting-data-using-a-dateoffset" title="Link to this heading">#</a></h3>
<p>It is also possible to select subsets of data for specific time intervals starting from the first dates or for the last dates in the selection using a <em><a class="reference internal" href="../../../back-matter/nb/glossary.html#term-DateOffset"><span class="xref std std-term">DateOffset</span></a></em>. A <code class="docutils literal notranslate"><span class="pre">DateOffset</span></code> is simply a duration of calendar time represented in a specific object in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. For example, if you would like to select values from the first two weeks and three days of January 2018 you could do the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_dt</span> <span class="o">=</span> <span class="n">start_dt</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_dt</span><span class="p">:</span><span class="n">end_dt</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>29.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2018-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>25.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>27.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>26.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2018-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>21.0</td>
      <td>-5.0</td>
    </tr>
    <tr>
      <th>2018-01-06</th>
      <td>GHCND:FI000007501</td>
      <td>23.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>2018-01-07</th>
      <td>GHCND:FI000007501</td>
      <td>22.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2018-01-08</th>
      <td>GHCND:FI000007501</td>
      <td>19.0</td>
      <td>-10.0</td>
    </tr>
    <tr>
      <th>2018-01-09</th>
      <td>GHCND:FI000007501</td>
      <td>22.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2018-01-10</th>
      <td>GHCND:FI000007501</td>
      <td>26.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2018-01-11</th>
      <td>GHCND:FI000007501</td>
      <td>24.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2018-01-12</th>
      <td>GHCND:FI000007501</td>
      <td>21.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>2018-01-13</th>
      <td>GHCND:FI000007501</td>
      <td>23.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2018-01-14</th>
      <td>GHCND:FI000007501</td>
      <td>27.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-15</th>
      <td>GHCND:FI000007501</td>
      <td>27.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>2018-01-16</th>
      <td>GHCND:FI000007501</td>
      <td>18.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2018-01-17</th>
      <td>GHCND:FI000007501</td>
      <td>10.0</td>
      <td>-18.0</td>
    </tr>
    <tr>
      <th>2018-01-18</th>
      <td>GHCND:FI000007501</td>
      <td>15.0</td>
      <td>-16.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here we have data for a total of 18 days produced using a combination of the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> accessor and the <code class="docutils literal notranslate"><span class="pre">pd.DateOffset()</span></code> function. The <code class="docutils literal notranslate"><span class="pre">pd.DateOffset()</span></code> function can be used to specify the time by which another time is shifted. The selection works by defining a starting date <code class="docutils literal notranslate"><span class="pre">start_dt</span></code> using the already familiar <code class="docutils literal notranslate"><span class="pre">datetime()</span></code> function. The ending time <code class="docutils literal notranslate"><span class="pre">end_dt</span></code> is then defined as the starting time plus a time offset of two weeks and three days using the <code class="docutils literal notranslate"><span class="pre">pd.DateOffset()</span></code> function. Recall that the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> accessor includes the end value in the selection, and thus our selection contains data from January 1st to January 18th.</p>
<p>Below is another example, looking at the last ten days of data from February 2020.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">end_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">start_dt</span> <span class="o">=</span> <span class="n">end_dt</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_dt</span><span class="p">:</span><span class="n">end_dt</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-02-20</th>
      <td>GHCND:FI000007501</td>
      <td>14.0</td>
      <td>-19.0</td>
    </tr>
    <tr>
      <th>2020-02-21</th>
      <td>GHCND:FI000007501</td>
      <td>33.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2020-02-22</th>
      <td>GHCND:FI000007501</td>
      <td>35.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>2020-02-23</th>
      <td>GHCND:FI000007501</td>
      <td>34.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>2020-02-24</th>
      <td>GHCND:FI000007501</td>
      <td>31.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2020-02-25</th>
      <td>GHCND:FI000007501</td>
      <td>25.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>2020-02-26</th>
      <td>GHCND:FI000007501</td>
      <td>14.0</td>
      <td>-21.0</td>
    </tr>
    <tr>
      <th>2020-02-27</th>
      <td>GHCND:FI000007501</td>
      <td>22.0</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>2020-02-28</th>
      <td>GHCND:FI000007501</td>
      <td>24.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2020-02-29</th>
      <td>GHCND:FI000007501</td>
      <td>17.0</td>
      <td>-19.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here we have a few differences compared to our first example. First off, because the last day of February is the 29th in leap years and the 28th otherwise, we find the last day in February by subtracting one day from the first day of March to find <code class="docutils literal notranslate"><span class="pre">end_dt</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">datetime(2020,</span> <span class="pre">3,</span> <span class="pre">1)</span> <span class="pre">-</span> <span class="pre">pd.DateOffset(days=1)</span></code>). If we had stated the last day in February as the 28th, the selection would omit February 29th in leap years. Secondly, because we want the last 10 days of the month, we subtract an offset of nine days from the starting date, yielding a selection of 10 days. Remember again that <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> includes the last value in the range in the selection. Additional useful details about date offsets can be found in the <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/timeseries.html#dateoffset-objects">pandas documentation for DateOffset objects</a> <a class="footnote-reference brackets" href="#dateoffsets" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
</section>
</section>
<section id="shifting-leading-and-lagging-time-series-data">
<h2>Shifting: Leading and lagging time series data<a class="headerlink" href="#shifting-leading-and-lagging-time-series-data" title="Link to this heading">#</a></h2>
<p>A typical task when working with time series data is to compare two consecutive values to each other. For instance, you might be interested in understanding how much warmer or colder temperatures were between different days, or want to compute percent differences in the value of a stock (to give a couple of examples). For these kind of operations, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides a functionality called <em><a class="reference internal" href="../../../back-matter/nb/glossary.html#term-Shifting"><span class="xref std std-term">shifting</span></a></em>, which can be used to move (shift) data backward or forward in time. In the following examples we will see this method in action by calculating the difference between consecutive temperature values. Let’s start by taking a small sample of data from 2023.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2023&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>30.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>28.0</td>
      <td>-5.0</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>12.0</td>
      <td>-7.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>-6.0</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see based on the <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> (<code class="docutils literal notranslate"><span class="pre">DATE</span></code>), we have temperature observations on a daily basis in this sample. Now, if we want to calculate the difference in temperature between consecutive observations we can take advantage of the <code class="docutils literal notranslate"><span class="pre">.shift()</span></code> method, which takes an integer value as an input. If you pass a positive number, the values in a given <code class="docutils literal notranslate"><span class="pre">Series</span></code> are shifted forward, and if you pass a negative number the values are shifted backwards. Let’s see an example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shifting forward</span>
<span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
2023-01-01     NaN
2023-01-02    30.0
2023-01-03    28.0
2023-01-04    12.0
2023-01-05    20.0
              ... 
2023-12-27    28.0
2023-12-28    23.0
2023-12-29     5.0
2023-12-30    11.0
2023-12-31     8.0
Name: TMAX_F, Length: 365, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As you can see, we shifted the values forward by one observation, which you can confirm by looking at how the position of value <code class="docutils literal notranslate"><span class="pre">30.0</span></code> has been moved forward by one day to January 2nd. Furthermore, by looking at the numeric values, you can see that the first value in the <code class="docutils literal notranslate"><span class="pre">Series</span></code> was replaced by <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. This is because the temperature values were shifted forward by one observation, meaning that there is no known temperature that could be filled in for the first observation. Hence, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> fills it with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. In a similar manner, when the observations are shifted backwards (with the argument <code class="docutils literal notranslate"><span class="pre">-1</span></code>) <code class="docutils literal notranslate"><span class="pre">NaN</span></code> is inserted at the very end of the <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shifting backward</span>
<span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
2023-01-01    28.0
2023-01-02    12.0
2023-01-03    20.0
2023-01-04    20.0
2023-01-05    17.0
              ... 
2023-12-27     5.0
2023-12-28    11.0
2023-12-29     8.0
2023-12-30    11.0
2023-12-31     NaN
Name: TMAX_F, Length: 365, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Another important thing to notice in these examples is that one observation is removed from the <code class="docutils literal notranslate"><span class="pre">Series</span></code> in both cases. In the first example the last known temperature (<code class="docutils literal notranslate"><span class="pre">8.0</span></code>) was dropped from the end of the <code class="docutils literal notranslate"><span class="pre">Series</span></code>, and in the second example the first temperature (<code class="docutils literal notranslate"><span class="pre">30.0</span></code>) was dropped. This is expected behavior because <code class="docutils literal notranslate"><span class="pre">pandas</span></code> wants to ensure that the <code class="docutils literal notranslate"><span class="pre">Series</span></code> keeps its shape (i.e., the length of the <code class="docutils literal notranslate"><span class="pre">Series</span></code> does not change). This behavior is beneficial because it is straightforward to do calculations between two <code class="docutils literal notranslate"><span class="pre">Series</span></code> from a single <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in this way, or to add the shifted values as a column in the same <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;next_day&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
      <th>next_day</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>30.0</td>
      <td>25.0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>28.0</td>
      <td>-5.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>12.0</td>
      <td>-7.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>-6.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>16.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2023-01-06</th>
      <td>GHCND:FI000007501</td>
      <td>17.0</td>
      <td>-19.0</td>
      <td>-18.0</td>
    </tr>
    <tr>
      <th>2023-01-07</th>
      <td>GHCND:FI000007501</td>
      <td>-18.0</td>
      <td>-30.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2023-01-08</th>
      <td>GHCND:FI000007501</td>
      <td>12.0</td>
      <td>-19.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2023-01-09</th>
      <td>GHCND:FI000007501</td>
      <td>16.0</td>
      <td>12.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2023-01-10</th>
      <td>GHCND:FI000007501</td>
      <td>17.0</td>
      <td>16.0</td>
      <td>17.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, the first value in the column <code class="docutils literal notranslate"><span class="pre">next_day</span></code> actually represents the temperature from January 2nd, the second value is from January 3rd, etc. because we shifted the values backwards. Thus, our data is structured such that it is very easy to do calculations between these two columns and calculate the difference in temperature between consecutive days, for example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;next_day&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span>
<span class="n">sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
      <th>next_day</th>
      <th>diff</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>30.0</td>
      <td>25.0</td>
      <td>28.0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>28.0</td>
      <td>-5.0</td>
      <td>12.0</td>
      <td>-16.0</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>12.0</td>
      <td>-7.0</td>
      <td>20.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>-6.0</td>
      <td>20.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2023-12-27</th>
      <td>GHCND:FI000007501</td>
      <td>23.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>-18.0</td>
    </tr>
    <tr>
      <th>2023-12-28</th>
      <td>GHCND:FI000007501</td>
      <td>5.0</td>
      <td>-8.0</td>
      <td>11.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2023-12-29</th>
      <td>GHCND:FI000007501</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>2023-12-30</th>
      <td>GHCND:FI000007501</td>
      <td>8.0</td>
      <td>-15.0</td>
      <td>11.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2023-12-31</th>
      <td>GHCND:FI000007501</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 5 columns</p>
</div></div></div>
</div>
<p>As you can see, the last value in the <code class="docutils literal notranslate"><span class="pre">diff</span></code> column is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, which is expected as we do not have information about the following day in the last row.</p>
<p>In the previous examples, we did “naive” shifts forward and backward by merely changing the position of the observations. Naturally, it is also possible to take advantage of our <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> and do more sophisticated shifts based on time. We can, for example, compare the temperatures between consecutive weeks or months, for example. Let’s see how we can calculate the weekly differences in the temperatures using the same <code class="docutils literal notranslate"><span class="pre">.shift()</span></code> method and adding the <code class="docutils literal notranslate"><span class="pre">freq</span></code> parameter, which accepts a <code class="docutils literal notranslate"><span class="pre">DateOffset</span></code> as an argument (which we already saw and used in the previous section). This time we will calculate the difference directly without storing the temperatures in a separate column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;weekly_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span>
<span class="n">sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
      <th>next_day</th>
      <th>diff</th>
      <th>weekly_diff</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>30.0</td>
      <td>25.0</td>
      <td>28.0</td>
      <td>-2.0</td>
      <td>-18.0</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>28.0</td>
      <td>-5.0</td>
      <td>12.0</td>
      <td>-16.0</td>
      <td>-12.0</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>12.0</td>
      <td>-7.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>-6.0</td>
      <td>20.0</td>
      <td>0.0</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>-3.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here, we specified <code class="docutils literal notranslate"><span class="pre">-7</span></code> as the first argument and passed the letter <code class="docutils literal notranslate"><span class="pre">&quot;D&quot;</span></code> to indicate days with the <code class="docutils literal notranslate"><span class="pre">freq</span></code> parameter, meaning that we want shift the observations by 7 days. Then, we calculated the difference between the temperatures for the following week and stored the result in a column called <code class="docutils literal notranslate"><span class="pre">weekly_diff</span></code>. In a similar manner, you can easily calculate differences between observations taken at different times, which can be very efficient and useful to understand changes in time series data sets.</p>
</section>
<section id="resampling-time-series-data">
<h2>Resampling time series data<a class="headerlink" href="#resampling-time-series-data" title="Link to this heading">#</a></h2>
<p>As we now know how to take advantage of the <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> to make selections, time zone conversions, and manipulate data by shifting observations, we are ready to further explore the functionalities of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> for working with temporal data. One common task when doing time series data analysis is to <em><span class="xref std std-term">resample</span></em> the time series from one frequency to another, such as aggregating daily temperature observations to monthly averages. This might sound familiar, as we did this process previously (in Chapter 3.3) using specific string manipulation tricks, and then grouping and aggregating the values. Now we will learn how to use resampling functionalities in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to conduct both downsampling (i.e., aggregating values) and upsampling based on specific <em><a class="reference internal" href="../../../back-matter/nb/glossary.html#term-Interpolation"><span class="xref std std-term">interpolation</span></a></em> methods. In general, when doing interpolation values that are missing between observations can be estimated using on specific criteria, such as taking the average between two consecutive observations. For instance, you could interpolate hourly temperature observations to calculate estimates at a 30-minute frequency by assuming that the temperature between two times, such as 10:00 and 11:00, is the average of both, giving you an estimate of the temperature at 10:30. Notice that whenever interpolating/upsampling data, you are basically making an “informed guess” and there is always uncertainty involved with your estimate.</p>
<p>Let’s start by downsampling our observations into monthly averages. To do this, we can use the <code class="docutils literal notranslate"><span class="pre">.resample()</span></code> method. The <code class="docutils literal notranslate"><span class="pre">.resample()</span></code> method works somewhat similarly to <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>, but it uses the <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> to allow you to easily control how the values should be grouped. Notice, however, that this only works with time series data (i.e., you need to make sure that you have a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> for your <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>). Whenever resampling data, you typically want to combine it with a specific aggregation method, such as <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">.max()</span></code>, or <code class="docutils literal notranslate"><span class="pre">.min()</span></code>, which will then specify how you want to aggregate the data, such as calculating the monthly averages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_averages</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="s2">&quot;TMIN_F&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">monthly_averages</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1908-01-01</th>
      <td>15.548387</td>
      <td>-3.689655</td>
    </tr>
    <tr>
      <th>1908-02-01</th>
      <td>17.000000</td>
      <td>-6.185185</td>
    </tr>
    <tr>
      <th>1908-03-01</th>
      <td>26.354839</td>
      <td>4.033333</td>
    </tr>
    <tr>
      <th>1908-04-01</th>
      <td>38.500000</td>
      <td>22.862069</td>
    </tr>
    <tr>
      <th>1908-05-01</th>
      <td>47.965517</td>
      <td>27.933333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The calculation above produces a new <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing numerical values that were aggregated to monthly averages. Before proceeding, however, it is good to note a few things. First, the <code class="docutils literal notranslate"><span class="pre">STATION_ID</span></code> column was not included in the aggregation because <code class="docutils literal notranslate"><span class="pre">pandas</span></code> does not know how to average a set of character strings. We can easily specify which columns should be aggregated by passing a list of column names after the <code class="docutils literal notranslate"><span class="pre">.resample()</span></code> function. Second, the attentive reader might have noticed that the monthly aggregation was stated using the string <code class="docutils literal notranslate"><span class="pre">&quot;MS&quot;</span></code> that was passed to the <code class="docutils literal notranslate"><span class="pre">.resample()</span></code> function. In this case, <code class="docutils literal notranslate"><span class="pre">&quot;MS&quot;</span></code> indicates that the monthly frequency should be used and that the associated values should be assigned to the start (or first day) of the month. Equivalently, <code class="docutils literal notranslate"><span class="pre">&quot;ME&quot;</span></code> would assign the values to the last day of the month. Following the example above, it is easy to calculate weekly average temperatures as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_averages</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1W&quot;</span><span class="p">)[[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="s2">&quot;TMIN_F&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">weekly_averages</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1908-01-05</th>
      <td>3.200000</td>
      <td>-30.600000</td>
    </tr>
    <tr>
      <th>1908-01-12</th>
      <td>1.571429</td>
      <td>-12.142857</td>
    </tr>
    <tr>
      <th>1908-01-19</th>
      <td>25.571429</td>
      <td>12.800000</td>
    </tr>
    <tr>
      <th>1908-01-26</th>
      <td>25.428571</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>1908-02-02</th>
      <td>16.000000</td>
      <td>-4.714286</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As expected, this produces a new <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing average weekly temperatures. Using this approach, it is very easy to change the resampling method and find the lowest temperatures for each week using the <code class="docutils literal notranslate"><span class="pre">.min()</span></code> function, for example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_min_temps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1W&quot;</span><span class="p">)[[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="s2">&quot;TMIN_F&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">weekly_min_temps</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1908-01-05</th>
      <td>-3.0</td>
      <td>-37.0</td>
    </tr>
    <tr>
      <th>1908-01-12</th>
      <td>-10.0</td>
      <td>-32.0</td>
    </tr>
    <tr>
      <th>1908-01-19</th>
      <td>23.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1908-01-26</th>
      <td>18.0</td>
      <td>-13.0</td>
    </tr>
    <tr>
      <th>1908-02-02</th>
      <td>7.0</td>
      <td>-34.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Upsampling of the data and interpolating the daily observations to a higher frequency (e.g., 12 hours) can be done similarly by estimating the missing values using linear interpolation, for example. Linear interpolation estimates the missing values between known points by fitting a straight line between the observations. Thus, the interpolated temperature between two consecutive days is the average the two (similar to the case discussed at the beginning of this section). Let’s have a look at an example of interpolating temperatures to a frequency of 12 hours from our daily observations. Note that we are explicitly excluding the <code class="docutils literal notranslate"><span class="pre">STATION_ID</span></code> column when making the selection of dates for this example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selection</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018-01-01&quot;</span><span class="p">:</span><span class="s2">&quot;2018-01-07&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="s2">&quot;TMIN_F&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">selection</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;12h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01 00:00:00</th>
      <td>29.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2018-01-01 12:00:00</th>
      <td>27.0</td>
      <td>23.5</td>
    </tr>
    <tr>
      <th>2018-01-02 00:00:00</th>
      <td>25.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-02 12:00:00</th>
      <td>26.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-03 00:00:00</th>
      <td>27.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2018-01-03 12:00:00</th>
      <td>26.5</td>
      <td>15.5</td>
    </tr>
    <tr>
      <th>2018-01-04 00:00:00</th>
      <td>26.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2018-01-04 12:00:00</th>
      <td>23.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>2018-01-05 00:00:00</th>
      <td>21.0</td>
      <td>-5.0</td>
    </tr>
    <tr>
      <th>2018-01-05 12:00:00</th>
      <td>22.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2018-01-06 00:00:00</th>
      <td>23.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>2018-01-06 12:00:00</th>
      <td>22.5</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>2018-01-07 00:00:00</th>
      <td>22.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As a result, our daily data has been converted to a higher frequency and the temperature at noon on the first of January 2018 is estimated to be 27 degrees Fahrenheit, which is the average of the values on January first and second. By default, the interpolation will automatically done for all columns containing numerical values. In this case we have used linear interpolation, but there are many other interpolation methods available as shown in the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.interpolate.html"><code class="docutils literal notranslate"><span class="pre">pandas</span></code> interpolation documentation</a> <a class="footnote-reference brackets" href="#interpolation" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="calculating-rolling-statistics">
<h2>Calculating rolling statistics<a class="headerlink" href="#calculating-rolling-statistics" title="Link to this heading">#</a></h2>
<p>The calculation of rolling statistics is yet another useful technique to deal with time series data that is “noisy” or that has gaps between observations. Calculating a moving average is a typical rolling statistics operation in which observations are weighted (averaged) over a moving “window”, which is an efficient way to smooth the data and reduce variance between observations. For example, stock market data or GPS observations of the movement / speed of vehicles are good examples of datasets that typically have large amounts of variance, which can make it challenging to see patterns without smoothing. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> supports various moving window functions, and each have differences in how they influence the end result. Some use a static window size and weigh the observations equally, whereas others can give more weight to more recent observations, for example. In the following we will see how a moving average can be calculated with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, and how it influences the interpretations of our data. Let’s start by taking a sample of our data covering 20 years and make a plot based on the maximum daily temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;1994&quot;</span><span class="p">:</span><span class="s2">&quot;2023&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/de77fdc289df55533d568eeaef463a37e336ca4762abe9d46cdade645ae63210.png" src="../../../_images/de77fdc289df55533d568eeaef463a37e336ca4762abe9d46cdade645ae63210.png" />
</div>
</div>
<p><em><strong>Figure 3.5</strong>. Temperature values in Fahrenheit for 1994-2023.</em></p>
<p>In this plot, time is on the x-axis and temperatures in Fahrenheit are on the y-axis. We can clearly see how the temperatures fluctuate throughout the year. Let’s investigate our data a bit further and take a look of the first rows of our sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_ID</th>
      <th>TMAX_F</th>
      <th>TMIN_F</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1994-01-01</th>
      <td>GHCND:FI000007501</td>
      <td>22.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1994-01-02</th>
      <td>GHCND:FI000007501</td>
      <td>19.0</td>
      <td>-10.0</td>
    </tr>
    <tr>
      <th>1994-01-03</th>
      <td>GHCND:FI000007501</td>
      <td>19.0</td>
      <td>-9.0</td>
    </tr>
    <tr>
      <th>1994-01-04</th>
      <td>GHCND:FI000007501</td>
      <td>18.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1994-01-05</th>
      <td>GHCND:FI000007501</td>
      <td>20.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we would expect, the first rows in our sample contain daily observations. Let’s see how we can apply rolling statistics with our time series and calculate a moving average based on four closest (consecutive) temperature observations. To do this, we can use the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> method, which takes an integer number as an argument by default to specify how many observations should be grouped together (i.e., the window size). By chaining the <code class="docutils literal notranslate"><span class="pre">.mean()</span></code> command after <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code>, we can specify that we want to calculate the average temperature based on those four observations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moving_temps</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">moving_temps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
1994-01-01      NaN
1994-01-02      NaN
1994-01-03      NaN
1994-01-04    19.50
1994-01-05    19.00
              ...  
2023-12-27    26.50
2023-12-28    21.25
2023-12-29    16.75
2023-12-30    11.75
2023-12-31     8.75
Name: TMAX_F, Length: 10957, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As output here, we get a <code class="docutils literal notranslate"><span class="pre">Series</span></code> in which time is the index and the newly calculated moving-window average temperatures are the values. As can be seen in this example, the first three temperature values are <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, which is expected because we specified that the average should always be based on four consecutive observations. Thus, the average cannot be calculated for the first three observations, and <code class="docutils literal notranslate"><span class="pre">pandas</span></code> returns <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>In addition, it is important to note that <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> and <code class="docutils literal notranslate"><span class="pre">.resample()</span></code> work similarly, but also have differences. The main difference is that the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> will maintain the number of observations in the data (but change the values according neighboring values, for example based on the mean), whereas <code class="docutils literal notranslate"><span class="pre">.resample()</span></code> will actually aggregate and reduce the number of observations that will be stored in the result.</p>
<p>With our data set, we are fortunate that we are working with observations at regular intervals (daily), but this is not always the case. In situations where the observations are made at irregular time intervals (e.g., several times per day at irregular intervals) using a moving window with a set number of observations can result in unwanted consequences and errors in the analysis. This issue can be handled by passing a <code class="docutils literal notranslate"><span class="pre">DateOffset</span></code> as an argument in the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> function, similar to how we did earlier when resampling our data. If the observations occur more frequently than daily, you might use a fixed window size of one day by passing <code class="docutils literal notranslate"><span class="pre">&quot;1D&quot;</span></code> to the function. This will keep the time span equal, no matter how many observations there would be recorded within a single day. Note, however, that the time interval being used should be equal, so values such as <code class="docutils literal notranslate"><span class="pre">&quot;1MS&quot;</span></code> for monthly intervals would not be consistent since the number of days in a month varies.</p>
<p>In our case, we can use this approach to easily calculate rolling statistics with different window sizes, such as weekly, monthly or even annual averages. We can do this by specifying a varying number of days for the moving window. To demonstrate the influence of “smoothing” our time series based on different moving window sizes, let’s calculate the moving average of temperatures based on window sizes of 180 days and 360 days (roughly one year), and plot the results (details about plotting are discussed in Chapter 4).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">half_year</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;180D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">annual</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;360D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Daily&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">half_year</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Half yearly&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">annual</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;TMAX_F&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Yearly&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (degrees Fahrenheit)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f7ab88292899ffedcb47cee6d055114e68f0556a2a91b3a03e4d6b7008393298.png" src="../../../_images/f7ab88292899ffedcb47cee6d055114e68f0556a2a91b3a03e4d6b7008393298.png" />
</div>
</div>
<p><em><strong>Figure 3.6</strong>. Temperature values and moving averages for 1994-2023.</em></p>
<p>As a result, we have three different lines showing how the raw daily temperature observations (<code class="docutils literal notranslate"><span class="pre">sample</span></code>, blue line) compare to those smoothed for roughly half a year (<code class="docutils literal notranslate"><span class="pre">half_year</span></code>, orange line) or one year (<code class="docutils literal notranslate"><span class="pre">annual</span></code>, green line). The daily values show how much temperature varies day to day in our data set, while yearly values roughly show how much temperatures vary from year to year. As we can observe, the variance between observations is reduced (i.e., smoothed) when the size of the window is larger.</p>
<p>It is worthwhile to note two other common rolling statistical calculations that can be done using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. First, it is possible to use exponentially weighted (EW) window functions to give more weight to observations that are closer to the center of the window (closer in time in our case) using a decay function. The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> method <code class="docutils literal notranslate"><span class="pre">.ewm()</span></code> can be used for this as described in the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.ewm.html"><code class="docutils literal notranslate"><span class="pre">pandas</span></code> documentation</a> ^[ewm]. Similar concepts are introduced in <a class="reference internal" href="../../../part3/chapter-10/index.html"><span class="std std-doc">a case study in Chapter 10</span></a> for predicting unknown values at specific geographic locations. Second, in addition to the moving window functions, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides a method called <code class="docutils literal notranslate"><span class="pre">.expanding()</span></code>, which increases the size of the window for each observation until it encompasses the whole series. This method basically accumulates the information on each observation, similar to cumulative summing, and can be useful in some predictive applications where cumulative information about the given phenomena can provide more accurate results using more observations, for example. More information about the <code class="docutils literal notranslate"><span class="pre">.expanding()</span></code> method can be found in the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.expanding.html"><code class="docutils literal notranslate"><span class="pre">pandas</span></code> documentation</a> ^[expanding].</p>
</section>
<section id="footnotes">
<h2>Footnotes<a class="headerlink" href="#footnotes" title="Link to this heading">#</a></h2>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="isostandard" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601">https://en.wikipedia.org/wiki/ISO_8601</a></p>
</aside>
<aside class="footnote brackets" id="dateoffsets" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/timeseries.html#dateoffset-objects">https://pandas.pydata.org/docs/user_guide/timeseries.html#dateoffset-objects</a></p>
</aside>
<aside class="footnote brackets" id="interpolation" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.interpolate.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.interpolate.html</a></p>
</aside>
</aside>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02-data-analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data wrangling, grouping and aggregation</p>
      </div>
    </a>
    <a class="right-next"
       href="04-exercises.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercises</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#date-and-time-basics">Date and time basics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-temporal-data-in-python">Working with temporal data in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-datetime-objects">Constructing datetime objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-temporal-components-from-datetime-object">Parsing temporal components from datetime object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-temporal-data-in-pandas">Working with temporal data in pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-time-zones-in-pandas">Handling time zones in pandas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-data-using-a-datetimeindex">Selecting data using a DatetimeIndex</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-data-using-a-dateoffset">Selecting data using a DateOffset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shifting-leading-and-lagging-time-series-data">Shifting: Leading and lagging time series data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-time-series-data">Resampling time series data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-rolling-statistics">Calculating rolling statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">Footnotes</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Henrikki Tenkanen, Vuokko Heikinheimo, David Whipp
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2024, Henrikki Tenkanen, Vuokko Heikinheimo, David Whipp.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>